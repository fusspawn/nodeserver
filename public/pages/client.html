<html>
	<head>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
		<script src="../socket.io/socket.io.js"></script>
	</head>
	<body>
	<div id="start_up">
		<input type="text" id="name" />
		<input type="submit" id="connect" />
	</div>
	<div id="after_connect">
		<div id="logger">
		</div>
		<input type="text" id="messagetext" />
		<input type="submit" id="send_chat" />
	</div>
	</body>
</html>

<script type="text/javascript">
	function after_connect() {
		$("#start_up").hide("fast");
		$("#after_connect").show("fast");
		
		$("#send_chat").click(function() {
			var packet = {}
			packet.client_name = chat_name;
			packet.message = $("#messagetext").val();
			socket.send(JSON.stringify(packet));
			console.log("sent message");
		});

		var socket = new io.Socket("testing.duostack.net");
		socket.connect();
		socket.on('connect', function(){ console.log("connected");
			var packet = {}
			packet.client_name = chat_name;
			packet.message = "connected";
			socket.send(JSON.stringify(packet));
		})
		
		socket.on('message', function(message){ 
			var data = JSON.parse(message);
			$("#logger").append(data.client_name + ": "+ data.message + "<br />");
		})
		
		socket.on('disconnect', function(){  console.log("Disco?!"); })
	}
	$(function() {
		$("#after_connect").hide("fast");
		$("#connect").click(function() {
			window.chat_name = $("#name").val();
			after_connect();
		});
	});
 </script>